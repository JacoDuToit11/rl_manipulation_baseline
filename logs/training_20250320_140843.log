Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|#####     | 1/2 [00:00<00:00,  1.38it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:01<00:00,  1.61it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:01<00:00,  1.57it/s]
/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py:390: UserWarning: The requested device cuda:0 is also being used for training. For higher throughput and to avoid out-of-memory errors, it is recommended to use a dedicated device for vLLM. If this is intentional, you may ignore this warning but should adjust `vllm_gpu_memory_utilization` accordingly.
  warnings.warn(
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.04s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.42it/s]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.33it/s]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|2         | 1/35 [00:00<00:15,  2.20it/s]Capturing CUDA graph shapes:   6%|5         | 2/35 [00:00<00:14,  2.35it/s]Capturing CUDA graph shapes:   9%|8         | 3/35 [00:01<00:13,  2.39it/s]Capturing CUDA graph shapes:  11%|#1        | 4/35 [00:01<00:12,  2.39it/s]Capturing CUDA graph shapes:  14%|#4        | 5/35 [00:02<00:12,  2.41it/s]Capturing CUDA graph shapes:  17%|#7        | 6/35 [00:02<00:11,  2.42it/s]Capturing CUDA graph shapes:  20%|##        | 7/35 [00:02<00:11,  2.42it/s]Capturing CUDA graph shapes:  23%|##2       | 8/35 [00:03<00:11,  2.42it/s]Capturing CUDA graph shapes:  26%|##5       | 9/35 [00:03<00:10,  2.41it/s]Capturing CUDA graph shapes:  29%|##8       | 10/35 [00:04<00:09,  2.50it/s]Capturing CUDA graph shapes:  31%|###1      | 11/35 [00:04<00:09,  2.62it/s]Capturing CUDA graph shapes:  34%|###4      | 12/35 [00:04<00:08,  2.72it/s]Capturing CUDA graph shapes:  37%|###7      | 13/35 [00:05<00:07,  2.79it/s]Capturing CUDA graph shapes:  40%|####      | 14/35 [00:05<00:07,  2.84it/s]Capturing CUDA graph shapes:  43%|####2     | 15/35 [00:05<00:06,  2.87it/s]Capturing CUDA graph shapes:  46%|####5     | 16/35 [00:06<00:06,  2.90it/s]Capturing CUDA graph shapes:  49%|####8     | 17/35 [00:06<00:06,  2.88it/s]Capturing CUDA graph shapes:  51%|#####1    | 18/35 [00:06<00:05,  2.90it/s]Capturing CUDA graph shapes:  54%|#####4    | 19/35 [00:07<00:05,  2.90it/s]Capturing CUDA graph shapes:  57%|#####7    | 20/35 [00:07<00:05,  2.93it/s]Capturing CUDA graph shapes:  60%|######    | 21/35 [00:07<00:04,  2.94it/s]Capturing CUDA graph shapes:  63%|######2   | 22/35 [00:08<00:04,  2.92it/s]Capturing CUDA graph shapes:  66%|######5   | 23/35 [00:08<00:04,  2.93it/s]Capturing CUDA graph shapes:  69%|######8   | 24/35 [00:08<00:03,  2.94it/s]Capturing CUDA graph shapes:  71%|#######1  | 25/35 [00:09<00:03,  2.95it/s]Capturing CUDA graph shapes:  74%|#######4  | 26/35 [00:09<00:03,  2.93it/s]Capturing CUDA graph shapes:  77%|#######7  | 27/35 [00:09<00:02,  2.93it/s]Capturing CUDA graph shapes:  80%|########  | 28/35 [00:10<00:02,  2.94it/s]Capturing CUDA graph shapes:  83%|########2 | 29/35 [00:10<00:02,  2.95it/s]Capturing CUDA graph shapes:  86%|########5 | 30/35 [00:10<00:01,  2.92it/s]Capturing CUDA graph shapes:  89%|########8 | 31/35 [00:11<00:01,  2.86it/s]Capturing CUDA graph shapes:  91%|#########1| 32/35 [00:11<00:01,  2.87it/s]Capturing CUDA graph shapes:  94%|#########4| 33/35 [00:11<00:00,  2.90it/s]Capturing CUDA graph shapes:  97%|#########7| 34/35 [00:12<00:00,  2.91it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:12<00:00,  2.88it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:12<00:00,  2.76it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|#####     | 1/2 [00:00<00:00,  1.41it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:01<00:00,  1.69it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:01<00:00,  1.64it/s]
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.05s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.40it/s]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.31it/s]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|2         | 1/35 [00:00<00:27,  1.22it/s]Capturing CUDA graph shapes:   6%|5         | 2/35 [00:01<00:26,  1.23it/s]Capturing CUDA graph shapes:   9%|8         | 3/35 [00:02<00:26,  1.22it/s]Capturing CUDA graph shapes:  11%|#1        | 4/35 [00:03<00:25,  1.22it/s]Capturing CUDA graph shapes:  14%|#4        | 5/35 [00:04<00:24,  1.23it/s]Capturing CUDA graph shapes:  17%|#7        | 6/35 [00:04<00:21,  1.32it/s]Capturing CUDA graph shapes:  20%|##        | 7/35 [00:05<00:21,  1.27it/s]Capturing CUDA graph shapes:  23%|##2       | 8/35 [00:06<00:21,  1.26it/s]Capturing CUDA graph shapes:  26%|##5       | 9/35 [00:07<00:20,  1.24it/s]Capturing CUDA graph shapes:  29%|##8       | 10/35 [00:08<00:20,  1.21it/s]Capturing CUDA graph shapes:  31%|###1      | 11/35 [00:08<00:19,  1.21it/s]Capturing CUDA graph shapes:  34%|###4      | 12/35 [00:09<00:17,  1.31it/s]Capturing CUDA graph shapes:  37%|###7      | 13/35 [00:10<00:16,  1.37it/s]Capturing CUDA graph shapes:  40%|####      | 14/35 [00:10<00:14,  1.44it/s]Capturing CUDA graph shapes:  43%|####2     | 15/35 [00:11<00:13,  1.49it/s]Capturing CUDA graph shapes:  46%|####5     | 16/35 [00:12<00:12,  1.53it/s]Capturing CUDA graph shapes:  49%|####8     | 17/35 [00:12<00:11,  1.56it/s]Capturing CUDA graph shapes:  51%|#####1    | 18/35 [00:13<00:10,  1.58it/s]Capturing CUDA graph shapes:  54%|#####4    | 19/35 [00:14<00:12,  1.33it/s]Capturing CUDA graph shapes:  57%|#####7    | 20/35 [00:15<00:11,  1.26it/s]Capturing CUDA graph shapes:  60%|######    | 21/35 [00:15<00:10,  1.32it/s]Capturing CUDA graph shapes:  63%|######2   | 22/35 [00:16<00:09,  1.39it/s]Capturing CUDA graph shapes:  66%|######5   | 23/35 [00:17<00:08,  1.44it/s]Capturing CUDA graph shapes:  69%|######8   | 24/35 [00:17<00:07,  1.48it/s]Capturing CUDA graph shapes:  71%|#######1  | 25/35 [00:18<00:06,  1.47it/s]Capturing CUDA graph shapes:  74%|#######4  | 26/35 [00:19<00:06,  1.50it/s]Capturing CUDA graph shapes:  77%|#######7  | 27/35 [00:19<00:05,  1.53it/s]Capturing CUDA graph shapes:  80%|########  | 28/35 [00:20<00:04,  1.56it/s]Capturing CUDA graph shapes:  83%|########2 | 29/35 [00:20<00:03,  1.57it/s]Capturing CUDA graph shapes:  86%|########5 | 30/35 [00:21<00:03,  1.58it/s]Capturing CUDA graph shapes:  89%|########8 | 31/35 [00:22<00:02,  1.55it/s]Capturing CUDA graph shapes:  91%|#########1| 32/35 [00:22<00:01,  1.57it/s]Capturing CUDA graph shapes:  94%|#########4| 33/35 [00:23<00:01,  1.58it/s]Capturing CUDA graph shapes:  97%|#########7| 34/35 [00:24<00:00,  1.59it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:24<00:00,  1.44it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:24<00:00,  1.40it/s]
  0%|          | 0/1 [00:00<?, ?it/s]100%|##########| 1/1 [00:18<00:00, 18.47s/it]                                             {'loss': 0.0, 'grad_norm': 0.2827182412147522, 'learning_rate': 5e-06, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.25, 'reward': 0.25, 'reward_std': 0.3535533845424652, 'completion_length': 452.75, 'kl': 0.0, 'epoch': 0.57}
100%|##########| 1/1 [00:18<00:00, 18.47s/it]                                             {'train_runtime': 19.0096, 'train_samples_per_second': 0.368, 'train_steps_per_second': 0.053, 'train_loss': 7.450580596923828e-09, 'epoch': 0.57}
100%|##########| 1/1 [00:19<00:00, 18.47s/it]100%|##########| 1/1 [00:19<00:00, 19.00s/it]
Training complete successfully; special code: AUTOMATIC ALIGNMENT COMPLETE
equest: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
