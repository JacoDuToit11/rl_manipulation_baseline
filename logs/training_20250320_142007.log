Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|#####     | 1/2 [00:00<00:00,  1.79it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:00<00:00,  2.22it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:00<00:00,  2.14it/s]
/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/trl/trainer/grpo_trainer.py:390: UserWarning: The requested device cuda:0 is also being used for training. For higher throughput and to avoid out-of-memory errors, it is recommended to use a dedicated device for vLLM. If this is intentional, you may ignore this warning but should adjust `vllm_gpu_memory_utilization` accordingly.
  warnings.warn(
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:00<00:00,  1.18it/s]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.72it/s]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.61it/s]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|2         | 1/35 [00:00<00:14,  2.39it/s]Capturing CUDA graph shapes:   6%|5         | 2/35 [00:00<00:12,  2.67it/s]Capturing CUDA graph shapes:   9%|8         | 3/35 [00:01<00:11,  2.79it/s]Capturing CUDA graph shapes:  11%|#1        | 4/35 [00:01<00:10,  2.86it/s]Capturing CUDA graph shapes:  14%|#4        | 5/35 [00:01<00:10,  2.89it/s]Capturing CUDA graph shapes:  17%|#7        | 6/35 [00:02<00:09,  2.91it/s]Capturing CUDA graph shapes:  20%|##        | 7/35 [00:02<00:09,  2.82it/s]Capturing CUDA graph shapes:  23%|##2       | 8/35 [00:02<00:09,  2.86it/s]Capturing CUDA graph shapes:  26%|##5       | 9/35 [00:03<00:08,  2.89it/s]Capturing CUDA graph shapes:  29%|##8       | 10/35 [00:03<00:08,  2.92it/s]Capturing CUDA graph shapes:  31%|###1      | 11/35 [00:03<00:08,  2.91it/s]Capturing CUDA graph shapes:  34%|###4      | 12/35 [00:04<00:07,  2.93it/s]Capturing CUDA graph shapes:  37%|###7      | 13/35 [00:04<00:07,  2.91it/s]Capturing CUDA graph shapes:  40%|####      | 14/35 [00:04<00:07,  2.92it/s]Capturing CUDA graph shapes:  43%|####2     | 15/35 [00:05<00:06,  2.94it/s]Capturing CUDA graph shapes:  46%|####5     | 16/35 [00:05<00:06,  2.95it/s]Capturing CUDA graph shapes:  49%|####8     | 17/35 [00:05<00:06,  2.93it/s]Capturing CUDA graph shapes:  51%|#####1    | 18/35 [00:06<00:05,  2.92it/s]Capturing CUDA graph shapes:  54%|#####4    | 19/35 [00:06<00:05,  2.90it/s]Capturing CUDA graph shapes:  57%|#####7    | 20/35 [00:06<00:05,  2.93it/s]Capturing CUDA graph shapes:  60%|######    | 21/35 [00:07<00:04,  2.94it/s]Capturing CUDA graph shapes:  63%|######2   | 22/35 [00:07<00:04,  2.93it/s]Capturing CUDA graph shapes:  66%|######5   | 23/35 [00:07<00:04,  2.93it/s]Capturing CUDA graph shapes:  69%|######8   | 24/35 [00:08<00:03,  2.87it/s]Capturing CUDA graph shapes:  71%|#######1  | 25/35 [00:08<00:03,  2.90it/s]Capturing CUDA graph shapes:  74%|#######4  | 26/35 [00:08<00:03,  2.92it/s]Capturing CUDA graph shapes:  77%|#######7  | 27/35 [00:09<00:02,  2.94it/s]Capturing CUDA graph shapes:  80%|########  | 28/35 [00:09<00:02,  2.94it/s]Capturing CUDA graph shapes:  83%|########2 | 29/35 [00:09<00:02,  2.96it/s]Capturing CUDA graph shapes:  86%|########5 | 30/35 [00:10<00:01,  2.96it/s]Capturing CUDA graph shapes:  89%|########8 | 31/35 [00:10<00:01,  2.88it/s]Capturing CUDA graph shapes:  91%|#########1| 32/35 [00:11<00:01,  2.89it/s]Capturing CUDA graph shapes:  94%|#########4| 33/35 [00:11<00:00,  2.92it/s]Capturing CUDA graph shapes:  97%|#########7| 34/35 [00:11<00:00,  2.88it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:12<00:00,  2.88it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:12<00:00,  2.90it/s]
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|#####     | 1/2 [00:00<00:00,  1.36it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:01<00:00,  1.57it/s]Loading checkpoint shards: 100%|##########| 2/2 [00:01<00:00,  1.53it/s]
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.14s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.40it/s]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:01<00:00,  1.29it/s]

Capturing CUDA graph shapes:   0%|          | 0/35 [00:00<?, ?it/s]Capturing CUDA graph shapes:   3%|2         | 1/35 [00:00<00:27,  1.23it/s]Capturing CUDA graph shapes:   6%|5         | 2/35 [00:01<00:26,  1.24it/s]Capturing CUDA graph shapes:   9%|8         | 3/35 [00:02<00:25,  1.24it/s]Capturing CUDA graph shapes:  11%|#1        | 4/35 [00:03<00:25,  1.23it/s]Capturing CUDA graph shapes:  14%|#4        | 5/35 [00:04<00:24,  1.24it/s]Capturing CUDA graph shapes:  17%|#7        | 6/35 [00:04<00:23,  1.23it/s]Capturing CUDA graph shapes:  20%|##        | 7/35 [00:05<00:21,  1.29it/s]Capturing CUDA graph shapes:  23%|##2       | 8/35 [00:06<00:19,  1.38it/s]Capturing CUDA graph shapes:  26%|##5       | 9/35 [00:06<00:17,  1.45it/s]Capturing CUDA graph shapes:  29%|##8       | 10/35 [00:07<00:16,  1.50it/s]Capturing CUDA graph shapes:  31%|###1      | 11/35 [00:08<00:15,  1.53it/s]Capturing CUDA graph shapes:  34%|###4      | 12/35 [00:08<00:14,  1.56it/s]Capturing CUDA graph shapes:  37%|###7      | 13/35 [00:09<00:13,  1.58it/s]Capturing CUDA graph shapes:  40%|####      | 14/35 [00:09<00:13,  1.59it/s]Capturing CUDA graph shapes:  43%|####2     | 15/35 [00:10<00:12,  1.60it/s]Capturing CUDA graph shapes:  46%|####5     | 16/35 [00:11<00:11,  1.61it/s]Capturing CUDA graph shapes:  49%|####8     | 17/35 [00:11<00:11,  1.61it/s]Capturing CUDA graph shapes:  51%|#####1    | 18/35 [00:12<00:10,  1.62it/s]Capturing CUDA graph shapes:  54%|#####4    | 19/35 [00:12<00:09,  1.63it/s]Capturing CUDA graph shapes:  57%|#####7    | 20/35 [00:13<00:09,  1.63it/s]Capturing CUDA graph shapes:  60%|######    | 21/35 [00:14<00:08,  1.64it/s]Capturing CUDA graph shapes:  63%|######2   | 22/35 [00:14<00:07,  1.64it/s]Capturing CUDA graph shapes:  66%|######5   | 23/35 [00:15<00:07,  1.64it/s]Capturing CUDA graph shapes:  69%|######8   | 24/35 [00:16<00:06,  1.63it/s]Capturing CUDA graph shapes:  71%|#######1  | 25/35 [00:16<00:06,  1.63it/s]Capturing CUDA graph shapes:  74%|#######4  | 26/35 [00:17<00:05,  1.63it/s]Capturing CUDA graph shapes:  77%|#######7  | 27/35 [00:17<00:04,  1.62it/s]Capturing CUDA graph shapes:  80%|########  | 28/35 [00:18<00:04,  1.61it/s]Capturing CUDA graph shapes:  83%|########2 | 29/35 [00:19<00:03,  1.62it/s]Capturing CUDA graph shapes:  86%|########5 | 30/35 [00:19<00:03,  1.62it/s]Capturing CUDA graph shapes:  89%|########8 | 31/35 [00:20<00:02,  1.63it/s]Capturing CUDA graph shapes:  91%|#########1| 32/35 [00:20<00:01,  1.62it/s]Capturing CUDA graph shapes:  94%|#########4| 33/35 [00:21<00:01,  1.63it/s]Capturing CUDA graph shapes:  97%|#########7| 34/35 [00:22<00:00,  1.63it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:22<00:00,  1.64it/s]Capturing CUDA graph shapes: 100%|##########| 35/35 [00:22<00:00,  1.54it/s]
  0%|          | 0/2649 [00:00<?, ?it/s]  0%|          | 1/2649 [00:16<12:24:59, 16.88s/it]                                                   {'loss': 0.0, 'grad_norm': 0.2615605294704437, 'learning_rate': 1.886792452830189e-08, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.03125, 'rewards/format_reward_func': 0.125, 'reward': 0.78125, 'reward_std': 0.7513009309768677, 'completion_length': 485.75, 'kl': 0.0, 'epoch': 0.0}
  0%|          | 1/2649 [00:16<12:24:59, 16.88s/it]  0%|          | 2/2649 [00:26<9:15:08, 12.58s/it]                                                   {'loss': -0.0, 'grad_norm': 0.4457588195800781, 'learning_rate': 3.773584905660378e-08, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.046875, 'rewards/format_reward_func': 0.375, 'reward': 0.421875, 'reward_std': 0.19887377880513668, 'completion_length': 181.375, 'kl': 0.0, 'epoch': 0.0}
  0%|          | 2/2649 [00:26<9:15:08, 12.58s/it]  0%|          | 3/2649 [00:51<13:27:43, 18.32s/it]                                                   {'loss': 0.0, 'grad_norm': 0.9422038197517395, 'learning_rate': 5.6603773584905664e-08, 'rewards/degradation_reward_func': -1.25, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': -0.30262500047683716, 'rewards/format_reward_func': 0.25, 'reward': -1.3026250004768372, 'reward_std': 2.549296662211418, 'completion_length': 488.25, 'kl': 0.0004287454721634276, 'epoch': 0.0}
  0%|          | 3/2649 [00:51<13:27:43, 18.32s/it]  0%|          | 4/2649 [01:07<12:49:19, 17.45s/it]                                                   {'loss': 0.0, 'grad_norm': 0.3064546585083008, 'learning_rate': 7.547169811320756e-08, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 1.25, 'rewards/xmlcount_reward_func': 0.046875, 'rewards/format_reward_func': 0.0, 'reward': 0.671875, 'reward_std': 0.9501747358590364, 'completion_length': 474.75, 'kl': 0.0003087095028604381, 'epoch': 0.0}
  0%|          | 4/2649 [01:07<12:49:19, 17.45s/it]  0%|          | 5/2649 [01:23<12:24:16, 16.89s/it]                                                   {'loss': 0.0, 'grad_norm': 0.48448577523231506, 'learning_rate': 9.433962264150944e-08, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 1.25, 'rewards/xmlcount_reward_func': 0.078125, 'rewards/format_reward_func': 0.125, 'reward': 1.453125, 'reward_std': 0.24306795187294483, 'completion_length': 432.625, 'kl': 0.0005847005231771618, 'epoch': 0.01}
  0%|          | 5/2649 [01:23<12:24:16, 16.89s/it]  0%|          | 6/2649 [01:35<11:05:12, 15.10s/it]                                                   {'loss': 0.0, 'grad_norm': 0.6140549778938293, 'learning_rate': 1.1320754716981133e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.25, 'reward': 0.875, 'reward_std': 0.8838834762573242, 'completion_length': 293.625, 'kl': 0.000829299446195364, 'epoch': 0.01}
  0%|          | 6/2649 [01:35<11:05:12, 15.10s/it]  0%|          | 7/2649 [01:57<12:54:43, 17.59s/it]                                                   {'loss': 0.0, 'grad_norm': 0.2920195162296295, 'learning_rate': 1.320754716981132e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.015625, 'rewards/format_reward_func': 0.125, 'reward': 0.140625, 'reward_std': 1.92244653403759, 'completion_length': 704.125, 'kl': 0.0003960128378821537, 'epoch': 0.01}
  0%|          | 7/2649 [01:57<12:54:43, 17.59s/it]  0%|          | 8/2649 [02:15<12:50:50, 17.51s/it]                                                   {'loss': 0.0, 'grad_norm': 0.3535773456096649, 'learning_rate': 1.5094339622641512e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.03125, 'rewards/format_reward_func': 0.125, 'reward': 0.15625, 'reward_std': 0.22097086533904076, 'completion_length': 411.0, 'kl': 0.00046806981845293194, 'epoch': 0.01}
  0%|          | 8/2649 [02:15<12:50:50, 17.51s/it]  0%|          | 9/2649 [02:26<11:29:34, 15.67s/it]                                                   {'loss': 0.0, 'grad_norm': 0.5904676914215088, 'learning_rate': 1.69811320754717e-07, 'rewards/degradation_reward_func': -1.25, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.04349999991245568, 'rewards/format_reward_func': 0.0, 'reward': -0.5815000534057617, 'reward_std': 0.8665593629702926, 'completion_length': 305.5, 'kl': 0.0004324491092120297, 'epoch': 0.01}
  0%|          | 9/2649 [02:26<11:29:34, 15.67s/it]  0%|          | 10/2649 [02:46<12:16:09, 16.74s/it]                                                    {'loss': 0.0, 'grad_norm': 0.4035211503505707, 'learning_rate': 1.886792452830189e-07, 'rewards/degradation_reward_func': -1.25, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.125, 'reward': -1.125, 'reward_std': 0.1767766922712326, 'completion_length': 598.25, 'kl': 0.00039057866524672136, 'epoch': 0.01}
  0%|          | 10/2649 [02:46<12:16:09, 16.74s/it]  0%|          | 11/2649 [03:01<11:58:59, 16.35s/it]                                                    {'loss': 0.0, 'grad_norm': 0.2919982969760895, 'learning_rate': 2.0754716981132077e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.015625, 'rewards/format_reward_func': 0.125, 'reward': 0.765625, 'reward_std': 1.0385630577802658, 'completion_length': 423.375, 'kl': 0.00047023828665260226, 'epoch': 0.01}
  0%|          | 11/2649 [03:01<11:58:59, 16.35s/it]  0%|          | 12/2649 [03:15<11:24:40, 15.58s/it]                                                    {'loss': 0.0, 'grad_norm': 0.2101566344499588, 'learning_rate': 2.2641509433962265e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': -0.08237500488758087, 'rewards/format_reward_func': 0.0, 'reward': -0.08237498998641968, 'reward_std': 2.0168452858924866, 'completion_length': 375.5, 'kl': 0.00043780735722975805, 'epoch': 0.01}
  0%|          | 12/2649 [03:15<11:24:40, 15.58s/it]  0%|          | 13/2649 [03:29<11:02:34, 15.08s/it]                                                    {'loss': 0.0, 'grad_norm': 0.5186929106712341, 'learning_rate': 2.4528301886792456e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 1.875, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.125, 'reward': 2.0, 'reward_std': 2.474873721599579, 'completion_length': 404.25, 'kl': 0.0006128864042693749, 'epoch': 0.01}
  0%|          | 13/2649 [03:29<11:02:34, 15.08s/it]  1%|          | 14/2649 [03:47<11:39:05, 15.92s/it]                                                    {'loss': 0.0, 'grad_norm': 0.16972492635250092, 'learning_rate': 2.641509433962264e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.0, 'reward': -0.625, 'reward_std': 0.8838834762573242, 'completion_length': 582.75, 'kl': 0.00035904859396396205, 'epoch': 0.02}
  1%|          | 14/2649 [03:47<11:39:05, 15.92s/it]  1%|          | 15/2649 [04:12<13:48:30, 18.87s/it]                                                    {'loss': 0.0, 'grad_norm': 0.34274938702583313, 'learning_rate': 2.8301886792452833e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0018749999580904841, 'rewards/format_reward_func': 0.125, 'reward': -0.4981250000419095, 'reward_std': 1.0633118189871311, 'completion_length': 631.5, 'kl': 0.0003534019851940684, 'epoch': 0.02}
  1%|          | 15/2649 [04:12<13:48:30, 18.87s/it]  1%|          | 16/2649 [04:33<14:18:08, 19.56s/it]                                                    {'loss': 0.0, 'grad_norm': 0.35157310962677, 'learning_rate': 3.0188679245283024e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.015625, 'rewards/format_reward_func': 0.125, 'reward': -0.484375, 'reward_std': 1.082757255062461, 'completion_length': 701.25, 'kl': 0.00037193034222582355, 'epoch': 0.02}
  1%|          | 16/2649 [04:33<14:18:08, 19.56s/it]  1%|          | 17/2649 [04:51<13:45:26, 18.82s/it]                                                    {'loss': 0.0, 'grad_norm': 0.5071670413017273, 'learning_rate': 3.207547169811321e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.12287499941885471, 'rewards/format_reward_func': 0.125, 'reward': 0.24787500500679016, 'reward_std': 0.17978189513087273, 'completion_length': 450.25, 'kl': 0.0006418122575269081, 'epoch': 0.02}
  1%|          | 17/2649 [04:51<13:45:26, 18.82s/it]  1%|          | 18/2649 [05:15<14:52:52, 20.36s/it]                                                    {'loss': 0.0, 'grad_norm': 0.46511104702949524, 'learning_rate': 3.39622641509434e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': -0.40199999511241913, 'rewards/format_reward_func': 0.125, 'reward': -0.27699999511241913, 'reward_std': 0.7452905178070068, 'completion_length': 699.0, 'kl': 0.0005962655341136269, 'epoch': 0.02}
  1%|          | 18/2649 [05:15<14:52:52, 20.36s/it]  1%|          | 19/2649 [05:35<14:50:34, 20.32s/it]                                                    {'loss': 0.0, 'grad_norm': 0.1613583117723465, 'learning_rate': 3.5849056603773586e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.015625, 'rewards/format_reward_func': 0.0, 'reward': 0.015625, 'reward_std': 0.022097086533904076, 'completion_length': 646.0, 'kl': 0.00046791484783170745, 'epoch': 0.02}
  1%|          | 19/2649 [05:35<14:50:34, 20.32s/it]  1%|          | 20/2649 [05:54<14:42:12, 20.13s/it]                                                    {'loss': 0.0, 'grad_norm': 0.3603787422180176, 'learning_rate': 3.773584905660378e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.25, 'reward': 0.25, 'reward_std': 0.3535533845424652, 'completion_length': 593.375, 'kl': 0.00043317941890563816, 'epoch': 0.02}
  1%|          | 20/2649 [05:54<14:42:12, 20.13s/it]  1%|          | 21/2649 [06:09<13:26:27, 18.41s/it]                                                    {'loss': 0.0, 'grad_norm': 0.36765509843826294, 'learning_rate': 3.9622641509433963e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': -0.252250000834465, 'rewards/format_reward_func': 0.25, 'reward': -0.627250000834465, 'reward_std': 1.2406188249588013, 'completion_length': 377.625, 'kl': 0.000587488197197672, 'epoch': 0.02}
  1%|          | 21/2649 [06:09<13:26:27, 18.41s/it]  1%|          | 22/2649 [06:28<13:40:06, 18.73s/it]                                                    {'loss': 0.0, 'grad_norm': 0.42816099524497986, 'learning_rate': 4.1509433962264154e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.25, 'reward': 0.25, 'reward_std': 0.3535533845424652, 'completion_length': 473.75, 'kl': 0.000526747593539767, 'epoch': 0.02}
  1%|          | 22/2649 [06:28<13:40:06, 18.73s/it]  1%|          | 23/2649 [06:53<15:03:20, 20.64s/it]                                                    {'loss': 0.0, 'grad_norm': 0.18918657302856445, 'learning_rate': 4.339622641509434e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': -0.022374998778104782, 'rewards/format_reward_func': 0.0, 'reward': -0.022374998778104782, 'reward_std': 0.12003137543797493, 'completion_length': 759.875, 'kl': 0.000381765712518245, 'epoch': 0.03}
  1%|          | 23/2649 [06:53<15:03:20, 20.64s/it]  1%|          | 24/2649 [07:14<15:01:13, 20.60s/it]                                                    {'loss': 0.0, 'grad_norm': 0.26665985584259033, 'learning_rate': 4.528301886792453e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 1.25, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.25, 'reward': 0.875, 'reward_std': 1.2374368607997894, 'completion_length': 606.75, 'kl': 0.00043743999412981793, 'epoch': 0.03}
  1%|          | 24/2649 [07:14<15:01:13, 20.60s/it]  1%|          | 25/2649 [07:31<14:15:15, 19.56s/it]                                                    {'loss': 0.0, 'grad_norm': 0.16577693819999695, 'learning_rate': 4.716981132075472e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.03125, 'rewards/format_reward_func': 0.0, 'reward': 0.03125, 'reward_std': 0.04419417306780815, 'completion_length': 549.375, 'kl': 0.00046605034003732726, 'epoch': 0.03}
  1%|          | 25/2649 [07:31<14:15:15, 19.56s/it]  1%|          | 26/2649 [07:59<16:06:41, 22.11s/it]                                                    {'loss': 0.0, 'grad_norm': 0.334329754114151, 'learning_rate': 4.905660377358491e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0625, 'rewards/format_reward_func': 0.125, 'reward': 0.1875, 'reward_std': 0.2651650384068489, 'completion_length': 719.375, 'kl': 0.0005750263953814283, 'epoch': 0.03}
  1%|          | 26/2649 [07:59<16:06:41, 22.11s/it]  1%|1         | 27/2649 [08:19<15:30:57, 21.30s/it]                                                    {'loss': 0.0, 'grad_norm': 0.2733658254146576, 'learning_rate': 5.09433962264151e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': -0.12387500703334808, 'rewards/format_reward_func': 0.0, 'reward': 0.5011249929666519, 'reward_std': 1.1474575251340866, 'completion_length': 467.625, 'kl': 0.0004049611379741691, 'epoch': 0.03}
  1%|1         | 27/2649 [08:19<15:30:57, 21.30s/it]  1%|1         | 28/2649 [08:38<15:01:25, 20.64s/it]                                                    {'loss': 0.0, 'grad_norm': 0.31823816895484924, 'learning_rate': 5.283018867924528e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.078125, 'rewards/format_reward_func': 0.0, 'reward': 0.078125, 'reward_std': 0.11048543266952038, 'completion_length': 546.0, 'kl': 0.0006392178620444611, 'epoch': 0.03}
  1%|1         | 28/2649 [08:38<15:01:25, 20.64s/it]  1%|1         | 29/2649 [08:52<13:44:10, 18.87s/it]                                                    {'loss': 0.0, 'grad_norm': 0.41584402322769165, 'learning_rate': 5.471698113207548e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.375, 'reward': 1.0, 'reward_std': 1.0606601685285568, 'completion_length': 287.375, 'kl': 0.0005139549102750607, 'epoch': 0.03}
  1%|1         | 29/2649 [08:52<13:44:10, 18.87s/it]  1%|1         | 30/2649 [09:14<14:16:31, 19.62s/it]                                                    {'loss': 0.0, 'grad_norm': 0.4463476836681366, 'learning_rate': 5.660377358490567e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': -0.08712500054389238, 'rewards/format_reward_func': 0.125, 'reward': 0.037874999456107616, 'reward_std': 0.303879143553786, 'completion_length': 424.0, 'kl': 0.0005082619245513342, 'epoch': 0.03}
  1%|1         | 30/2649 [09:14<14:16:31, 19.62s/it]  1%|1         | 31/2649 [09:28<13:12:02, 18.15s/it]                                                    {'loss': 0.0, 'grad_norm': 0.35058388113975525, 'learning_rate': 5.849056603773586e-07, 'rewards/degradation_reward_func': -1.25, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.25, 'reward': -0.375, 'reward_std': 0.883883461356163, 'completion_length': 327.5, 'kl': 0.0005097148823551834, 'epoch': 0.04}
  1%|1         | 31/2649 [09:28<13:12:02, 18.15s/it]  1%|1         | 32/2649 [09:47<13:19:45, 18.34s/it]                                                    {'loss': 0.0, 'grad_norm': 0.0012149986578151584, 'learning_rate': 6.037735849056605e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.0, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.25, 'reward': 0.25, 'reward_std': 0.0, 'completion_length': 544.5, 'kl': 0.00032693283719709143, 'epoch': 0.04}
  1%|1         | 32/2649 [09:47<13:19:45, 18.34s/it]  1%|1         | 33/2649 [09:59<11:49:13, 16.27s/it]                                                    {'loss': 0.0, 'grad_norm': 0.563018262386322, 'learning_rate': 6.226415094339623e-07, 'rewards/degradation_reward_func': -0.625, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.03125, 'rewards/format_reward_func': 0.375, 'reward': 0.40625, 'reward_std': 1.9887378066778183, 'completion_length': 239.25, 'kl': 0.0005751497665187344, 'epoch': 0.04}
  1%|1         | 33/2649 [09:59<11:49:13, 16.27s/it]  1%|1         | 34/2649 [10:20<13:00:08, 17.90s/it]                                                    {'loss': 0.0, 'grad_norm': 0.3099839389324188, 'learning_rate': 6.415094339622642e-07, 'rewards/degradation_reward_func': 0.0, 'rewards/improvement_reward_func': 0.625, 'rewards/xmlcount_reward_func': 0.0, 'rewards/format_reward_func': 0.125, 'reward': 0.75, 'reward_std': 1.0606601685285568, 'completion_length': 639.5, 'kl': 0.0004682524595409632, 'epoch': 0.04}
  1%|1         | 34/2649 [10:20<13:00:08, 17.90s/it][rank0]: Traceback (most recent call last):
[rank0]:   File "/workspace/rl_manipulation_human_baseline/train.py", line 224, in <module>
[rank0]:     trainer.train()
[rank0]:   File "/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/transformers/trainer.py", line 2548, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:   File "/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/transformers/trainer.py", line 3740, in training_step
[rank0]:     self.accelerator.backward(loss, **kwargs)
[rank0]:   File "/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/accelerate/accelerator.py", line 2359, in backward
[rank0]:     loss.backward(**kwargs)
[rank0]:   File "/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/torch/_tensor.py", line 581, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
[rank0]:     _engine_run_backward(
[rank0]:   File "/workspace/rl_manipulation_human_baseline/.venv/lib/python3.10/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.32 GiB. GPU 0 has a total capacity of 79.25 GiB of which 1.85 GiB is free. Process 3111515 has 77.37 GiB memory in use. Of the allocated memory 70.55 GiB is allocated by PyTorch, with 52.00 MiB allocated in private pools (e.g., CUDA Graphs), and 5.98 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
  1%|1         | 34/2649 [10:33<13:31:53, 18.63s/it]
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:09,119 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:09,638 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:15,118 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:15,678 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:22,068 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:22,638 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:25,790 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:26,358 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:30,051 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:30,520 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:35,544 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:36,020 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:39,621 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:40,126 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:43,450 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:43,961 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:47,072 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:47,506 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:50,630 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:54,736 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:58,158 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:28:58,693 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:03,018 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:03,571 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:14,612 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:15,256 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:23,084 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:23,496 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:26,056 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:26,477 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:31,013 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:31,862 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:34,633 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:35,154 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:38,957 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:39,423 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:43,302 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:43,755 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:48,476 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:48,952 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:53,466 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:54,187 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:55,880 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:56,299 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:29:58,695 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:01,624 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:05,105 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:05,674 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:08,333 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:09,001 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:13,870 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:14,602 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:17,041 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:17,700 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:20,751 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:21,330 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:24,550 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:30,360 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:33,252 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:34,109 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:36,642 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:37,126 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:40,512 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:41,412 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:44,554 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:45,092 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:47,797 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:48,689 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:53,263 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:53,820 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:59,440 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:30:59,923 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:03,270 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:03,835 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:06,932 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:07,424 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:10,697 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:11,187 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:12,846 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:13,264 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:14,784 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:15,272 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:20,418 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:21,053 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:24,620 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:25,118 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:31,192 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:31,791 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:36,451 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:36,949 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:47,782 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-03-20 14:31:48,308 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
